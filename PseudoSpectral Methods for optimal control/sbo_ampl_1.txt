param N = 20;
param Tmax = 1.5700;
param A = 1.0000;

param x0 = 0.0000;
param y0 = 0.0000;
param z0 = 1.0000;
set nodes := 1..(N+1);
var x {nodes} >= -1 <= 1;
var y {nodes} >= -1 <= 1;
var z {nodes} >= -1 <= 1;
var u {nodes} >= -A <= A;
var v {nodes} >= -A <= A;
maximize cost: x[N+1];

subject to dynamics_x {t in nodes}:
	u[t]*z[t] = (2/T)*(sum{k in nodes} D[t,k]*x[k]);
subject to dynamics_y {t in nodes}:
	-v[t]*z[t]= (2/T)*(sum{k in nodes} D[t,k]*y[k]);
subject to dynamics_z {t in nodes}:
	v[t]*y[t]-u[t]x[t]= (2/T)*(sum{k in nodes} D[t,k]*z[k]);
subject to initialCondition_x {t in nodes}: x[1] = x0;

subject to initialCondition_y {t in nodes}: y[1] = y0;

subject to initialCondition_z {t in nodes}: z[1] = z0;

subject to amplitudeBound {t in nodes}:
	u[t]^2+v[t]^2 <= A^2;
data;

param D :
	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21 :=
	1	-105.000000	142.052260	-56.865646	32.498118	-21.661629	15.746185	-12.100995	9.665204	-7.939193	6.659599	-5.675464	4.894327	-4.256283	3.720432	-3.257235	2.843792	-2.460426	2.087322	-1.699071	1.248703	-0.500000
	2	-23.177764	0.000000	32.830982	-15.342289	9.567230	-6.744631	5.097456	-4.030477	3.289039	-2.746544	2.333182	-2.007337	1.742588	-1.521171	1.330426	-1.160648	1.003591	-0.851035	0.692529	-0.508868	0.203743
	3	5.223230	-18.482029	0.000000	18.966591	-9.174558	5.889089	-4.248653	3.270637	-2.624290	2.166726	-1.826022	1.561947	-1.350125	1.174757	-1.024912	0.892439	-0.770579	0.652761	-0.530799	0.389856	-0.156063
	4	-2.111979	6.110800	-13.419347	0.000000	13.524625	-6.629740	4.311905	-3.147336	2.447082	-1.979776	1.645442	-1.393618	1.195912	-1.034943	0.899236	-0.780577	0.672421	-0.568638	0.461845	-0.338965	0.135650
	5	1.109320	-3.002814	5.115188	-10.657603	0.000000	10.693407	-5.275745	3.455223	-2.538536	1.985030	-1.613504	1.345722	-1.142146	0.980427	-0.846721	0.731654	-0.628139	0.529877	-0.429629	0.314992	-0.126002
	6	-0.678464	1.781091	-2.762551	4.395583	-8.997084	0.000000	9.012539	-4.462144	2.933999	-2.163748	1.697406	-1.382985	1.154879	-0.979862	0.839017	-0.720408	0.615589	-0.517530	0.418640	-0.306499	0.122532
	7	0.459307	-1.185802	1.755675	-2.518372	3.910210	-7.939219	0.000000	7.946891	-3.942565	2.598330	-1.920200	1.508630	-1.229908	1.026262	-0.868309	0.739097	-0.627562	0.525200	-0.423525	0.309492	-0.123632
	8	-0.334827	0.855741	-1.233537	1.677726	-2.337328	3.587579	-7.253114	0.000000	7.257205	-3.604628	2.378536	-1.759315	1.382428	-1.125833	0.936668	-0.787813	0.663222	-0.551689	0.443066	-0.322971	0.128885
	9	0.258524	-0.656401	0.930350	-1.226143	1.614141	-2.217341	3.382367	-6.821565	0.000000	6.823731	-3.391337	2.238754	-1.655685	1.299442	-1.055151	0.872789	-0.726240	0.599227	-0.478640	0.347772	-0.138597
	10	-0.209202	0.528786	-0.741023	0.956978	-1.217639	1.577512	-2.150451	3.268649	-6.582868	0.000000	6.583817	-3.272562	2.159731	-1.595333	1.248585	-1.008285	0.825480	-0.673642	0.534188	-0.386469	0.153748
	11	0.176197	-0.443938	0.617183	-0.786047	0.978142	-1.223014	1.570587	-2.131561	3.233288	-6.506657	0.000000	6.506657	-3.233288	2.131561	-1.570587	1.223014	-0.978142	0.786047	-0.617183	0.443938	-0.176197
	12	-0.153748	0.386469	-0.534188	0.673642	-0.825480	1.008285	-1.248585	1.595333	-2.159731	3.272562	-6.583817	0.000000	6.582868	-3.268649	2.150451	-1.577512	1.217639	-0.956978	0.741023	-0.528786	0.209202
	13	0.138597	-0.347772	0.478640	-0.599227	0.726240	-0.872789	1.055151	-1.299442	1.655685	-2.238754	3.391337	-6.823731	0.000000	6.821565	-3.382367	2.217341	-1.614141	1.226143	-0.930350	0.656401	-0.258524
	14	-0.128885	0.322971	-0.443066	0.551689	-0.663222	0.787813	-0.936668	1.125833	-1.382428	1.759315	-2.378536	3.604628	-7.257205	0.000000	7.253114	-3.587579	2.337328	-1.677726	1.233537	-0.855741	0.334827
	15	0.123632	-0.309492	0.423525	-0.525200	0.627562	-0.739097	0.868309	-1.026262	1.229908	-1.508630	1.920200	-2.598330	3.942565	-7.946891	0.000000	7.939219	-3.910210	2.518372	-1.755675	1.185802	-0.459307
	16	-0.122532	0.306499	-0.418640	0.517530	-0.615589	0.720408	-0.839017	0.979862	-1.154879	1.382985	-1.697406	2.163748	-2.933999	4.462144	-9.012539	0.000000	8.997084	-4.395583	2.762551	-1.781091	0.678464
	17	0.126002	-0.314992	0.429629	-0.529877	0.628139	-0.731654	0.846721	-0.980427	1.142146	-1.345722	1.613504	-1.985030	2.538536	-3.455223	5.275745	-10.693407	0.000000	10.657603	-5.115188	3.002814	-1.109320
	18	-0.135650	0.338965	-0.461845	0.568638	-0.672421	0.780577	-0.899236	1.034943	-1.195912	1.393618	-1.645442	1.979776	-2.447082	3.147336	-4.311905	6.629740	-13.524625	0.000000	13.419347	-6.110800	2.111979
	19	0.156063	-0.389856	0.530799	-0.652761	0.770579	-0.892439	1.024912	-1.174757	1.350125	-1.561947	1.826022	-2.166726	2.624290	-3.270637	4.248653	-5.889089	9.174558	-18.966591	0.000000	18.482029	-5.223230
	20	-0.203743	0.508868	-0.692529	0.851035	-1.003591	1.160648	-1.330426	1.521171	-1.742588	2.007337	-2.333182	2.746544	-3.289039	4.030477	-5.097456	6.744631	-9.567230	15.342289	-32.830982	0.000000	23.177764
	21	0.500000	-1.248703	1.699071	-2.087322	2.460426	-2.843792	3.257235	-3.720432	4.256283	-4.894327	5.675464	-6.659599	7.939193	-9.665204	12.100995	-15.746185	21.661629	-32.498118	56.865646	-142.052260	105.000000
;
