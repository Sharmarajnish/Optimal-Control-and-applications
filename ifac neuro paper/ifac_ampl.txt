param N = 24;
param Tmax = 4.0000;
param eps = 250000.0000;

param nPY = 1;
param nIN = 2;
param nTC = 3;
param nRE = 4;
set nodes := 1..(N+1);
set states := 1..4;

param D {nodes,nodes};
param times {nodes};
param wts {nodes};

param x0 {states};
param xT {states};
param tau {states};
param h {states};
param C {1..9};

var T >=0 <= Tmax;
var x {states,nodes} >= -2 <= 2;
var u {nodes} >= -2 <= 2;
maximize cost:  - 0.100000*(T/Tmax) - 1.000000*(sum{t in nodes} (u[t]^2)*wts[t]);

subject to dynamics_PY {t in nodes}:
	tau[nPY]*(h[nPY] - x[nPY,t] + C[1]*(1/(1+eps^(-x[nPY,t]))) - C[3]*(1/(1+eps^(-x[nIN,t]))) + C[9]*(1/(1+eps^(-x[nTC,t])))) + u[t] = (2/T)*(sum{k in nodes} D[t,k]*x[nPY,k]);

subject to dynamics_IN {t in nodes}:
	tau[nIN]*(h[nIN] - x[nIN,t] + C[2]*(1/(1+eps^(-x[nPY,t])))) + u[t] = (2/T)*(sum{k in nodes} D[t,k]*x[nIN,k]);

subject to dynamics_TC {t in nodes}:
	tau[nTC]*(h[nTC] - x[nTC,t] - C[6]*(1/(1+eps^(-x[nRE,t]))) + C[7]*(1/(1+eps^(-x[nPY,t])))) = (2/T)*(sum{k in nodes} D[t,k]*x[nTC,k]);

subject to dynamics_RE {t in nodes}:
	tau[nRE]*(h[nRE] - x[nRE,t] - C[4]*(1/(1+eps^(-x[nRE,t]))) + C[5]*(1/(1+eps^(-x[nTC,t]))) + C[8]*(1/(1+eps^(-x[nPY,t])))) = (2/T)*(sum{k in nodes} D[t,k]*x[nRE,k]);

subject to initialCondition {j in states}: x[j,1] = x0[j];

subject to fixedTime: T=Tmax;

subject to terminalCondition: (sum{j in 1..4} (x[j,N+1] - xT[j])^2) <= 0.0001;

subject to zerou0: u[1] = 0;

subject to zerouT: u[N+1] = 0;

data;

param C :=
  1	1.800000
  2	4.000000
  3	1.500000
  4	0.200000
  5	10.000000
  6	1.500000
  7	3.000000
  8	3.000000
  9	1.000000
;
param h :=
  1	-0.350000
  2	-3.400000
  3	-2.000000
  4	-5.000000
;
param tau :=
  1	1.000000
  2	1.250000
  3	0.100000
  4	0.100000
;
param x0 :=
  1	0.000000
  2	0.000000
  3	0.000000
  4	0.000000
;
param xT :=
  1	0.169500
  2	0.163900
  3	-0.091400
  4	0.003100
;
param wts :=
  1	0.003333
  2	0.020465
  3	0.036505
  4	0.051936
  5	0.066514
  6	0.079999
  7	0.092170
  8	0.102828
  9	0.111797
  10	0.118931
  11	0.124112
  12	0.127255
  13	0.128308
  14	0.127255
  15	0.124112
  16	0.118931
  17	0.111797
  18	0.102828
  19	0.092170
  20	0.079999
  21	0.066514
  22	0.051936
  23	0.036505
  24	0.020465
  25	0.003333
;
param times :=
  1	0.000000
  2	0.024420
  3	0.081472
  4	0.170034
  5	0.288647
  6	0.435361
  7	0.607766
  8	0.803032
  9	1.017952
  10	1.248997
  11	1.492374
  12	1.744086
  13	2.000000
  14	2.255914
  15	2.507626
  16	2.751003
  17	2.982048
  18	3.196968
  19	3.392234
  20	3.564639
  21	3.711353
  22	3.829966
  23	3.918528
  24	3.975580
  25	4.000000
;
param D :
	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25 :=
	1	-150.000000	202.932064	-81.237835	46.428952	-30.951316	22.505211	-17.304116	13.832914	-11.378353	9.564826	-8.177488	7.085331	-6.204234	5.477791	-4.866702	4.342576	-3.884114	3.474626	-3.100273	2.748633	-2.407210	2.061251	-1.689049	1.246516	-0.500000
	2	-33.053243	0.000000	46.819743	-21.880304	13.645858	-9.622435	7.275978	-5.757809	4.704967	-3.937169	3.355188	-2.900118	2.534867	-2.234930	1.983428	-1.768282	1.580501	-1.413090	1.260287	-1.116950	0.977941	-0.837222	0.685944	-0.506180	0.203030
	3	7.418017	-26.247933	0.000000	26.936400	-13.030856	8.366234	-6.038401	4.651989	-3.737428	3.091982	-2.613758	2.245956	-1.954406	1.717295	-1.520001	1.352285	-1.206666	1.077417	-0.959892	0.850007	-0.743736	0.636405	-0.521233	0.384552	-0.154231
	4	-2.979869	8.621807	-18.932955	0.000000	19.081810	-9.355269	6.086704	-4.445788	3.460647	-2.805022	2.338077	-1.988901	1.717827	-1.500869	1.322614	-1.172627	1.043502	-0.929710	0.826870	-0.731219	0.639124	-0.546458	0.447314	-0.329902	0.132294
	5	1.551124	-4.198604	7.151727	-14.899740	0.000000	14.950152	-7.377633	4.834395	-3.555341	2.784791	-2.269621	1.900718	-1.623164	1.406204	-1.231199	1.086104	-0.962696	0.855043	-0.758587	0.669535	-0.584333	0.499051	-0.408185	0.300896	-0.120637
	6	-0.937731	2.461597	-3.817648	6.073560	-12.430070	0.000000	12.451826	-6.167152	4.058266	-2.997132	2.356757	-1.927424	1.618831	-1.385550	1.202126	-1.053088	0.928386	-0.821074	0.726024	-0.639125	0.556674	-0.474716	0.387872	-0.285737	0.114528
	7	0.625803	-1.615535	2.391558	-3.429749	5.324000	-10.807522	0.000000	10.818435	-5.369949	3.542975	-2.623560	2.068100	-1.694924	1.425857	-1.221575	1.060016	-0.927723	0.815877	-0.718270	0.630150	-0.547427	0.465927	-0.380173	0.279830	-0.112121
	8	-0.448416	1.145938	-1.651492	2.245472	-3.127101	4.797959	-9.697129	0.000000	9.703161	-4.823041	3.187472	-2.364270	1.866462	-1.531374	1.289021	-1.104179	0.957039	-0.835444	0.731313	-0.638784	0.553079	-0.469577	0.382491	-0.281238	0.112635
	9	0.339255	-0.861271	1.220366	-1.607666	2.115245	-2.903968	4.427193	-8.924683	0.000000	8.928217	-4.441770	2.938560	-2.181769	1.723630	-1.414587	1.190284	-1.018280	0.880257	-0.764851	0.664324	-0.572755	0.484766	-0.394007	0.289320	-0.115808
	10	-0.268077	0.677491	-0.949053	1.224929	-1.557429	2.016013	-2.745760	4.170007	-8.392685	0.000000	8.394792	-4.178654	2.766101	-2.054593	1.623272	-1.331553	1.118888	-0.954675	0.821499	-0.708357	0.607417	-0.512076	0.415070	-0.304278	0.121711
	11	0.219627	-0.553246	0.768778	-0.978397	1.216328	-1.519093	1.948352	-2.640851	4.001051	-8.044365	0.000000	8.045564	-4.005960	2.652336	-1.969954	1.555511	-1.274230	1.067967	-0.907186	0.774853	-0.659820	0.553464	-0.447074	0.327053	-0.130707
	12	-0.185594	0.466398	-0.644282	0.811725	-0.993469	1.211674	-1.497915	1.910441	-2.581617	3.905327	-7.846855	0.000000	7.847402	-3.907561	2.586828	-1.920201	1.514262	-1.237422	1.032741	-0.871025	0.734996	-0.612546	0.492628	-0.359422	0.143486
	13	0.161180	-0.404311	0.556044	-0.695336	0.841431	-1.009322	1.217546	-1.495807	1.901015	-2.563945	3.874944	-7.782975	0.000000	7.782975	-3.874944	2.563945	-1.901015	1.495807	-1.217546	1.009322	-0.841431	0.695336	-0.556044	0.404311	-0.161180
	14	-0.143486	0.359422	-0.492628	0.612546	-0.734996	0.871025	-1.032741	1.237422	-1.514262	1.920201	-2.586828	3.907561	-7.847402	0.000000	7.846855	-3.905327	2.581617	-1.910441	1.497915	-1.211674	0.993469	-0.811725	0.644282	-0.466398	0.185594
	15	0.130707	-0.327053	0.447074	-0.553464	0.659820	-0.774853	0.907186	-1.067967	1.274230	-1.555511	1.969954	-2.652336	4.005960	-8.045564	0.000000	8.044365	-4.001051	2.640851	-1.948352	1.519093	-1.216328	0.978397	-0.768778	0.553246	-0.219627
	16	-0.121711	0.304278	-0.415070	0.512076	-0.607417	0.708357	-0.821499	0.954675	-1.118888	1.331553	-1.623272	2.054593	-2.766101	4.178654	-8.394792	0.000000	8.392685	-4.170007	2.745760	-2.016013	1.557429	-1.224929	0.949053	-0.677491	0.268077
	17	0.115808	-0.289320	0.394007	-0.484766	0.572755	-0.664324	0.764851	-0.880257	1.018280	-1.190284	1.414587	-1.723630	2.181769	-2.938560	4.441770	-8.928217	0.000000	8.924683	-4.427193	2.903968	-2.115245	1.607666	-1.220366	0.861271	-0.339255
	18	-0.112635	0.281238	-0.382491	0.469577	-0.553079	0.638784	-0.731313	0.835444	-0.957039	1.104179	-1.289021	1.531374	-1.866462	2.364270	-3.187472	4.823041	-9.703161	0.000000	9.697129	-4.797959	3.127101	-2.245472	1.651492	-1.145938	0.448416
	19	0.112121	-0.279830	0.380173	-0.465927	0.547427	-0.630150	0.718270	-0.815877	0.927723	-1.060016	1.221575	-1.425857	1.694924	-2.068100	2.623560	-3.542975	5.369949	-10.818435	0.000000	10.807522	-5.324000	3.429749	-2.391558	1.615535	-0.625803
	20	-0.114528	0.285737	-0.387872	0.474716	-0.556674	0.639125	-0.726024	0.821074	-0.928386	1.053088	-1.202126	1.385550	-1.618831	1.927424	-2.356757	2.997132	-4.058266	6.167152	-12.451826	0.000000	12.430070	-6.073560	3.817648	-2.461597	0.937731
	21	0.120637	-0.300896	0.408185	-0.499051	0.584333	-0.669535	0.758587	-0.855043	0.962696	-1.086104	1.231199	-1.406204	1.623164	-1.900718	2.269621	-2.784791	3.555341	-4.834395	7.377633	-14.950152	0.000000	14.899740	-7.151727	4.198604	-1.551124
	22	-0.132294	0.329902	-0.447314	0.546458	-0.639124	0.731219	-0.826870	0.929710	-1.043502	1.172627	-1.322614	1.500869	-1.717827	1.988901	-2.338077	2.805022	-3.460647	4.445788	-6.086704	9.355269	-19.081810	0.000000	18.932955	-8.621807	2.979869
	23	0.154231	-0.384552	0.521233	-0.636405	0.743736	-0.850007	0.959892	-1.077417	1.206666	-1.352285	1.520001	-1.717295	1.954406	-2.245956	2.613758	-3.091982	3.737428	-4.651989	6.038401	-8.366234	13.030856	-26.936400	0.000000	26.247933	-7.418017
	24	-0.203030	0.506180	-0.685944	0.837222	-0.977941	1.116950	-1.260287	1.413090	-1.580501	1.768282	-1.983428	2.234930	-2.534867	2.900118	-3.355188	3.937169	-4.704967	5.757809	-7.275978	9.622435	-13.645858	21.880304	-46.819743	0.000000	33.053243
	25	0.500000	-1.246516	1.689049	-2.061251	2.407210	-2.748633	3.100273	-3.474626	3.884114	-4.342576	4.866702	-5.477791	6.204234	-7.085331	8.177488	-9.564826	11.378353	-13.832914	17.304116	-22.505211	30.951316	-46.428952	81.237835	-202.932064	150.000000
;
solve;
display N;
display Tmax;
display x0;
display xT;
display T;
display eps;
display C;
display h;
display tau;
display x;
display u;
display cost;
